\subsection{Min boundary derivative polynomial}

The polynomial is of the form: 

\begin{align*}
    B_{min} \left( \beta \right) &= 
    a + b \beta + c \beta^2 + d \beta^3                   \\
    B_{min} \left( \widetilde{r} \right) &= 
    a + b \left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)+
    c\left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)  ^2+
    d\left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)^3                    \\
\end{align*}
Taking the derivative,
\begin{align*}
    B'_{min} \left( \widetilde{r} \right) &= 
    b \left( \frac{1}{1 - \sigma} \right)+
    2 c\left( \frac{1}{1 - \sigma} \right)\left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)  +
    3 d\left( \frac{1}{1-\sigma} \right)\left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)^2\\
    B'_{min} \left( \beta \right) &= 
    \left( \frac{1}{1 - \sigma} \right)
    \left[
    b +
    2 c \beta + 
    3 d \beta^2
    \right]
\end{align*}


Applying the four constraints gives:
\begin{align*}
    a &= 0\\
    b &= \left( 1 - \sigma \right) \\
    a + b + c + d &= 0\\
    2 + 2c + 3d &= 0
\end{align*}
\begin{align*}
    c + d &= -b  \\
    2c + 3d &= -b
\end{align*}
\begin{align*}
    c &= -2b \\
    d &= b
\end{align*}

and the min boundary derivative polynomial is: 
\begin{align*}
    B_{min}\left( \widetilde{r} \right) &= 
    b \left( \frac{\widetilde{r} - \sigma }{1 - \sigma}\right) -
    2b\left( \frac{\widetilde{r} - \sigma }{1 - \sigma}\right) ^2 +
    b \left( \frac{\widetilde{r} - \sigma }{1 - \sigma}\right)^3 \\
    &=  \left( 1 - \sigma \right)
    \left( \left( \frac{\widetilde{r} - \sigma }{1 - \sigma}\right)  - 
    2\left( \frac{\widetilde{r} - \sigma }{1 - \sigma}\right)^2 +
    \left( \frac{\widetilde{r} - \sigma }{1 - \sigma}\right)^3\right)
\end{align*} 
\subsection{Polynomial function, max boundary derivative}
The polynomial is of the form:

The polynomial is of the form: 

\begin{align*}
    B_{max} \left( \beta \right) &= 
    a + b \beta + c \beta^2 + d \beta^3                   \\
    B_{max} \left( \widetilde{r} \right) &= 
    a + b \left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)+
    c\left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)  ^2+
    d\left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)^3                    \\
\end{align*}
which has the derivative,


\begin{align*}
    B'_{max} \left( \widetilde{r} \right) &= 
    b \left( \frac{1}{1 - \sigma} \right)+
    2 c\left( \frac{1}{1 - \sigma} \right)\left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)  +
    3 d\left( \frac{1}{1-\sigma} \right)\left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)^2\\
    B'_{max} \left( \beta \right) &= 
    \left( \frac{1}{1 - \sigma} \right)
    \left[
    b +
    2 c \beta + 
    3 d \beta^2
    \right]
\end{align*}
Applying the four constraints gives:
\begin{align*}
    a &= 0 \\
    b &= 0 \\
    a + b + c + d &= 0 \\
    b + 2c + 3d &= (1-\sigma)
\end{align*} 

working this out: 

\begin{align*}
    c + d &=  0 \\
    2c + 3d &= (1 - \sigma)
\end{align*} 

gives 

\begin{align*}
    c &= -\left( 1 - \sigma\right)
    d &= \left( 1 - \sigma\right)
\end{align*}
and the max boundary derivative polynomial is:

\begin{align*}
    B_{max} \left( \widetilde{r} \right) &= 
    \left( 1 - \sigma \right) \left( 
        - \left( \frac{\widetilde{r}-\sigma}{1 - \sigma} \right)^2 +
        \left( \frac{\widetilde{r}-\sigma}{1-\sigma} \right)^3
    \right)
\end{align*}
\subsection{Putting it together}

The corrected function is then: 
\begin{align*}
    f_{BCsImposed} \left( \widetilde{r} \right) &= 
    f_{MS} + 
    B_{min}\left( \widetilde{r} \right) \Delta f'_{minBC} +
    B_{max}\left( \widetilde{r} \right) \Delta f'_{maxBC}
\end{align*}
\begin{align*}
    &= 
    f_{MS} + \\
    \left( 1 - \sigma \right) \left( 
        \left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right) 
        - \left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right) ^2
\right) \Delta f'_{minBC} + \\
\left( 1 - \sigma \right) \left( - \left( \frac{\widetilde{r} - \sigma}{1 - \sigma} \right)^2 + 
    \left( \frac{\widetilde{r} - \sigma}{1 - \sigma}  \right)^3
\right)
\left( \Delta f'_{minBC} + \Delta f'_{maxBC} \right) 
\end{align*}
