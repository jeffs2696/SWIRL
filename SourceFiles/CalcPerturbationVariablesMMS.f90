 

 
    SUBROUTINE CalcPerturbationVariables(& 
    k    , &
    r    , &
    vR   , &
    vTh  , &
    vX   , &
    Pr)
    

    REAL(KIND=rDef)  ,DIMENSION(:), INTENT(IN)    :: r
    REAL(KIND=rDef)  ,DIMENSION(:), INTENT(INOUT) :: vR, vTh, vX, Pr
    COMPLEX(KIND=rDef), DIMENSION(:), INTENT(IN) :: k
    
    ! Local variables
    INTEGER :: numberOfGridPoints, i
    
    numberOfGridPoints = SIZE(vR)
      DO i = 1, numberOfGridPoints
vR(i) =0.763888888888943d0*r(i) + 3.56038411458294d0*(r(i) - 0.2d0)**5 - &
      5.15407986111027d0*(r(i) - 0.2d0)**4 + 0.651041666666159d0*(r(i) - &
      0.2d0)**3 - 3.47222222222222d0*tanh(125.0d0*r(i) - 125.0d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 110.71428571428572d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 96.428571428571431d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 82.142857142857139d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 67.857142857142861d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 53.571428571428584d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 39.285714285714292d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 25.0d0)**2 + 27.625d0
vTh(i)=1.51909722222205d0*(r(i) - 0.2d0)**3 - 1.82291666666646d0*(r(i) - 0.2d0)**2 + &
      0.0277777777777778d0*tanh(125.0d0*r(i) - 125.0d0) + &
      0.0277777777777778d0*tanh(125.0d0*r(i) - 110.71428571428572d0) + &
      0.0277777777777778d0*tanh(125.0d0*r(i) - 96.428571428571431d0) + &
      0.0277777777777778d0*tanh(125.0d0*r(i) - 82.142857142857139d0) + &
      0.0277777777777778d0*tanh(125.0d0*r(i) - 67.857142857142861d0) + &
      0.0277777777777778d0*tanh(125.0d0*r(i) - 53.571428571428584d0) + &
      0.0277777777777778d0*tanh(125.0d0*r(i) - 39.285714285714292d0) + &
      0.0277777777777778d0*tanh(125.0d0*r(i) - 25.0d0) + &
      0.194444444444423d0
vX(i) =0.0454545454545455d0*tanh(2.5d0*r(i) - 2.5d0) + 0.0454545454545455d0*tanh( &
      2.5d0*r(i) - 2.2777777777777777d0) + 0.0454545454545455d0*tanh(2.5d0 &
      *r(i) - 2.0555555555555554d0) + 0.0454545454545455d0*tanh(2.5d0*r(i) - &
      1.8333333333333335d0) + 0.0454545454545455d0*tanh(2.5d0*r(i) - &
      1.6111111111111112d0) + 0.0454545454545455d0*tanh(2.5d0*r(i) - &
      1.3888888888888888d0) + 0.0454545454545455d0*tanh(2.5d0*r(i) - &
      1.1666666666666667d0) + 0.0454545454545455d0*tanh(2.5d0*r(i) - &
      0.94444444444444464d0) + 0.0454545454545455d0*tanh(2.5d0*r(i) - &
      0.72222222222222232d0) + 0.0454545454545455d0*tanh(2.5d0*r(i) - &
      0.5d0) + 0.707850846972511d0
Pr(i) =0.763888888888943d0*r(i) + 3.56038411458294d0*(r(i) - 0.2d0)**5 - &
      5.15407986111027d0*(r(i) - 0.2d0)**4 + 0.651041666666159d0*(r(i) - &
      0.2d0)**3 - 3.47222222222222d0*tanh(125.0d0*r(i) - 125.0d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 110.71428571428572d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 96.428571428571431d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 82.142857142857139d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 67.857142857142861d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 53.571428571428584d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 39.285714285714292d0)**2 - &
      3.47222222222222d0*tanh(125.0d0*r(i) - 25.0d0)**2 + 27.625d0

      END DO
    END SUBROUTINE CalcPerturbationVariables
