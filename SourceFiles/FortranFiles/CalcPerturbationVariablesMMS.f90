 
    
     
        SUBROUTINE CalcPerturbationVariables(& 
        r    , &
        vR   , &
        vTh  , &
        vX   , &
        Pr)
        
    
        REAL(KIND=rDef)  ,DIMENSION(:), INTENT(IN)    :: r
        REAL(KIND=rDef)  ,DIMENSION(:), INTENT(INOUT) :: vR, vTh, vX, Pr
    
        
        ! Local variables
        INTEGER :: numberOfGridPoints, i
        
        numberOfGridPoints = SIZE(vR)
          DO i = 1, numberOfGridPoints
    vR(i) =0.555097781308866d0*(r(i)  - 0.3d0)**3 - 0.58285267037431d0*(r(i)  - 0.3d0)**2 + &
      0.125d0*tanh(1.4285714285714286d0*r(i)  - 1.4285714285714286d0) + &
      0.0951992694944706d0
vTh(i)=0.0416666666666667d0*tanh(28.571428571428573d0*r(i)  - 28.571428571428573d0 &
      ) + 0.0416666666666667d0*tanh(28.571428571428573d0*r(i)  - &
      23.571428571428573d0) + 0.0416666666666667d0*tanh( &
      28.571428571428573d0*r(i)  - 18.571428571428573d0) + &
      0.0416666666666667d0*tanh(28.571428571428573d0*r(i)  - &
      13.571428571428573d0) + 0.0416666666666667d0*tanh( &
      28.571428571428573d0*r(i)  - 8.5714285714285712d0) + &
      0.833337116660829d0
vX(i) =0.0416666666666667d0*tanh(28.571428571428573d0*r(i)  - 28.571428571428573d0 &
      ) + 0.0416666666666667d0*tanh(28.571428571428573d0*r(i)  - &
      23.571428571428573d0) + 0.0416666666666667d0*tanh( &
      28.571428571428573d0*r(i)  - 18.571428571428573d0) + &
      0.0416666666666667d0*tanh(28.571428571428573d0*r(i)  - &
      13.571428571428573d0) + 0.0416666666666667d0*tanh( &
      28.571428571428573d0*r(i)  - 8.5714285714285712d0) + &
      0.833337116660829d0
Pr(i) =0.512194744559897d0*r(i)  - 1.75371650820654d0*(r(i)  - 0.3d0)**3 + &
      0.495894777801869d0*(r(i)  - 0.3d0)**2 + 0.125d0*tanh( &
      14.285714285714286d0*r(i)  - 14.285714285714286d0) + &
      0.846341576632031d0

          END DO
        END SUBROUTINE CalcPerturbationVariables
    