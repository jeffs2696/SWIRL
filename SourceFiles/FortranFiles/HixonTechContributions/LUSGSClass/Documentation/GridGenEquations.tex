\section{LU-SGS for the Grid Generation Equations}

The 4D grid generation equations have this form:

\begin{eqnarray}
RHS_x
&=&
\left(
\begin{array}{r}
\alpha_{11} \widehat{\phi}_1 x_{\xi} 
\\
+
\alpha_{22} \widehat{\phi}_2 x_{\eta} 
\\
+
\alpha_{33} \widehat{\phi}_3 x_{\zeta} 
\\
+
\alpha_{44} \widehat{\phi}_4 x_{\tau} 
\end{array}
\right)
+
\left(
\begin{array}{r}
\left(\alpha_{11} + x_{\xi}^2 \beta_1 \right) x_{\xi \xi}
\\
+ x_{\xi} y_{\xi} \beta_1 y_{\xi \xi} 
\\
+ x_{\xi} z_{\xi} \beta_1 z_{\xi \xi} 
\\
+ x_{\xi} t_{\xi} \beta_1 t_{\xi \xi} 
\\
+
\left(\alpha_{22} + x_{\eta}^2 \beta_2 \right) x_{\eta \eta}
\\
+ x_{\eta} y_{\eta} \beta_2 y_{\eta \eta} 
\\
+ x_{\eta} z_{\eta} \beta_2 z_{\eta \eta} 
\\
+ x_{\eta} t_{\eta} \beta_2 t_{\eta \eta} 
\\
+
\left(\alpha_{33} + x_{\zeta}^2 \beta_3 \right) x_{\zeta \zeta}
\\
+ x_{\zeta} y_{\zeta} \beta_3 y_{\zeta \zeta} 
\\
+ x_{\zeta} z_{\zeta} \beta_3 z_{\zeta \zeta} 
\\
+ x_{\zeta} t_{\zeta} \beta_3 t_{\zeta \zeta} 
\\
+
\left(\alpha_{44} + x_{\tau}^2 \beta_4 \right) x_{\tau \tau}
\\
+ x_{\tau} y_{\tau} \beta_4 y_{\tau \tau} 
\\
+ x_{\tau} z_{\tau} \beta_4 z_{\tau \tau} 
\\
+ x_{\tau} t_{\tau} \beta_4 t_{\tau \tau} 
\\
+ 2 \alpha_{12} x_{\xi \eta}
+ 2 \alpha_{13} x_{\xi \zeta}
+ 2 \alpha_{14} x_{\xi \tau}
\\
+ 2 \alpha_{23} x_{\eta \zeta}
+ 2 \alpha_{24} x_{\eta \tau}
+ 2 \alpha_{34} x_{\zeta \tau}
\end{array}
\right)
\nonumber
\end{eqnarray}

\begin{eqnarray}
RHS_y
&=&
\left(
\begin{array}{r}
\alpha_{11} \widehat{\phi}_1 y_{\xi} 
\\
+
\alpha_{22} \widehat{\phi}_2 y_{\eta} 
\\
+
\alpha_{33} \widehat{\phi}_3 y_{\zeta} 
\\
+
\alpha_{44} \widehat{\phi}_4 y_{\tau} 
\end{array}
\right)
+
\left(
\begin{array}{r}
\left(\alpha_{11} + y_{\xi}^2 \beta_1 \right) y_{\xi \xi}
\\
+ x_{\xi} y_{\xi} \beta_1 x_{\xi \xi} 
\\
+ y_{\xi} z_{\xi} \beta_1 z_{\xi \xi} 
\\
+ y_{\xi} t_{\xi} \beta_1 t_{\xi \xi} 
\\
+
\left(\alpha_{22} + y_{\eta}^2 \beta_2 \right) y_{\eta \eta}
\\
+ x_{\eta} y_{\eta} \beta_2 x_{\eta \eta} 
\\
+ y_{\eta} z_{\eta} \beta_2 z_{\eta \eta} 
\\
+ y_{\eta} t_{\eta} \beta_2 t_{\eta \eta} 
\\
+
\left(\alpha_{33} + y_{\zeta}^2 \beta_3 \right) y_{\zeta \zeta}
\\
+ x_{\zeta} y_{\zeta} \beta_3 x_{\zeta \zeta} 
\\
+ y_{\zeta} z_{\zeta} \beta_3 z_{\zeta \zeta} 
\\
+ y_{\zeta} t_{\zeta} \beta_3 t_{\zeta \zeta} 
\\
+
\left(\alpha_{44} + y_{\tau}^2 \beta_4 \right) y_{\tau \tau}
\\
+ x_{\tau} y_{\tau} \beta_4 x_{\tau \tau} 
\\
+ y_{\tau} z_{\tau} \beta_4 z_{\tau \tau} 
\\
+ y_{\tau} t_{\tau} \beta_4 t_{\tau \tau} 
\\
+ 2 \alpha_{12} y_{\xi \eta}
+ 2 \alpha_{13} y_{\xi \zeta}
+ 2 \alpha_{14} y_{\xi \tau}
\\
+ 2 \alpha_{23} y_{\eta \zeta}
+ 2 \alpha_{24} y_{\eta \tau}
+ 2 \alpha_{34} y_{\zeta \tau}
\end{array}
\right)
\nonumber
\end{eqnarray}

\begin{eqnarray}
RHS_z
&=&
\left(
\begin{array}{r}
\alpha_{11} \widehat{\phi}_1 z_{\xi} 
\\
+
\alpha_{22} \widehat{\phi}_2 z_{\eta} 
\\
+
\alpha_{33} \widehat{\phi}_3 z_{\zeta} 
\\
+
\alpha_{44} \widehat{\phi}_4 z_{\tau} 
\end{array}
\right)
+
\left(
\begin{array}{r}
\left(\alpha_{11} + z_{\xi}^2 \beta_1 \right) z_{\xi \xi}
\\
+ x_{\xi} z_{\xi} \beta_1 x_{\xi \xi} 
\\
+ y_{\xi} z_{\xi} \beta_1 y_{\xi \xi} 
\\
+ z_{\xi} t_{\xi} \beta_1 t_{\xi \xi} 
\\
+
\left(\alpha_{22} + z_{\eta}^2 \beta_2 \right) z_{\eta \eta}
\\
+ x_{\eta} z_{\eta} \beta_2 x_{\eta \eta} 
\\
+ y_{\eta} z_{\eta} \beta_2 y_{\eta \eta} 
\\
+ z_{\eta} t_{\eta} \beta_2 t_{\eta \eta} 
\\
+
\left(\alpha_{33} + z_{\zeta}^2 \beta_3 \right) z_{\zeta \zeta}
\\
+ x_{\zeta} z_{\zeta} \beta_3 x_{\zeta \zeta} 
\\
+ y_{\zeta} z_{\zeta} \beta_3 y_{\zeta \zeta} 
\\
+ z_{\zeta} t_{\zeta} \beta_3 t_{\zeta \zeta} 
\\
+
\left(\alpha_{44} + z_{\tau}^2 \beta_4 \right) z_{\tau \tau}
\\
+ x_{\tau} z_{\tau} \beta_4 x_{\tau \tau} 
\\
+ y_{\tau} z_{\tau} \beta_4 y_{\tau \tau} 
\\
+ z_{\tau} t_{\tau} \beta_4 t_{\tau \tau} 
\\
+ 2 \alpha_{12} z_{\xi \eta}
+ 2 \alpha_{13} z_{\xi \zeta}
+ 2 \alpha_{14} z_{\xi \tau}
\\
+ 2 \alpha_{23} z_{\eta \zeta}
+ 2 \alpha_{24} z_{\eta \tau}
+ 2 \alpha_{34} z_{\zeta \tau}
\end{array}
\right)
\nonumber
\end{eqnarray}

\begin{eqnarray}
RHS_t
&=&
\left(
\begin{array}{r}
\alpha_{11} \widehat{\phi}_1 t_{\xi} 
\\
+
\alpha_{22} \widehat{\phi}_2 t_{\eta} 
\\
+
\alpha_{33} \widehat{\phi}_3 t_{\zeta} 
\\
+
\alpha_{44} \widehat{\phi}_4 t_{\tau} 
\end{array}
\right)
+
\left(
\begin{array}{r}
\left(\alpha_{11} + t_{\xi}^2 \beta_1 \right) t_{\xi \xi}
\\
+ x_{\xi} t_{\xi} \beta_1 x_{\xi \xi} 
\\
+ y_{\xi} t_{\xi} \beta_1 y_{\xi \xi} 
\\
+ z_{\xi} t_{\xi} \beta_1 z_{\xi \xi} 
\\
+
\left(\alpha_{22} + t_{\eta}^2 \beta_2 \right) t_{\eta \eta}
\\
+ x_{\eta} t_{\eta} \beta_2 x_{\eta \eta} 
\\
+ y_{\eta} t_{\eta} \beta_2 y_{\eta \eta} 
\\
+ z_{\eta} t_{\eta} \beta_2 z_{\eta \eta} 
\\
+
\left(\alpha_{33} + t_{\zeta}^2 \beta_3 \right) t_{\zeta \zeta}
\\
+ x_{\zeta} t_{\zeta} \beta_3 x_{\zeta \zeta} 
\\
+ y_{\zeta} t_{\zeta} \beta_3 y_{\zeta \zeta} 
\\
+ z_{\zeta} t_{\zeta} \beta_3 z_{\zeta \zeta} 
\\
+
\left(\alpha_{44} + t_{\tau}^2 \beta_4 \right) t_{\tau \tau}
\\
+ x_{\tau} t_{\tau} \beta_4 x_{\tau \tau} 
\\
+ y_{\tau} t_{\tau} \beta_4 y_{\tau \tau} 
\\
+ z_{\tau} t_{\tau} \beta_4 z_{\tau \tau} 
\\
+ 2 \alpha_{12} t_{\xi \eta}
+ 2 \alpha_{13} t_{\xi \zeta}
+ 2 \alpha_{14} t_{\xi \tau}
\\
+ 2 \alpha_{23} t_{\eta \zeta}
+ 2 \alpha_{24} t_{\eta \tau}
+ 2 \alpha_{34} t_{\zeta \tau}
\end{array}
\right)
\nonumber
\end{eqnarray}

where

\begin{eqnarray}
\alpha_{11} &=& \xi_x^2 + \xi_y^2 + \xi_z^2 + \xi_t^2
\nonumber
\\
\alpha_{12} &=& \xi_x \eta_x + \xi_y \eta_y + \xi_z \eta_z + \xi_t \eta_t
\nonumber
\\
\alpha_{13} &=& \xi_x \zeta_x + \xi_y \zeta_y + \xi_z \zeta_z + \xi_t \zeta_t
\nonumber
\\
\alpha_{14} &=& \xi_x \tau_x + \xi_y \tau_y + \xi_z \tau_z + \xi_t \tau_t
\nonumber
\\
\alpha_{22} &=& \eta_x^2 + \eta_y^2 + \eta_z^2 + \eta_t^2
\nonumber
\\
\alpha_{23} &=& \eta_x \zeta_x + \eta_y \zeta_y + \eta_z \zeta_z + \eta_t \zeta_t
\nonumber
\\
\alpha_{24} &=& \eta_x \tau_x + \eta_y \tau_y + \eta_z \tau_z + \eta_t \tau_t
\nonumber
\\
\alpha_{33} &=& \zeta_x^2 + \zeta_y^2 + \zeta_z^2 + \zeta_t^2
\nonumber
\\
\alpha_{34} &=& \zeta_x \tau_x + \zeta_y \tau_y + \zeta_z \tau_z + \zeta_t \tau_t
\nonumber
\\
\alpha_{44} &=& \tau_x^2 + \tau_y^2 + \tau_z^2 + \tau_t^2
\nonumber
\end{eqnarray}

and

\begin{eqnarray}
\beta_1 &=& 
\frac{\alpha_{11}}{
x_{\xi}^2
+
y_{\xi}^2
+
z_{\xi}^2
+
t_{\xi}^2
}
\nonumber
\\
\beta_2 &=& 
\frac{\alpha_{22}}{
x_{\eta}^2
+
y_{\eta}^2
+
z_{\eta}^2
+
t_{\eta}^2
}
\nonumber
\\
\beta_3 &=& 
\frac{\alpha_{33}}{
x_{\zeta}^2
+
y_{\zeta}^2
+
z_{\zeta}^2
+
t_{\zeta}^2
}
\nonumber
\\
\beta_4 &=& 
\frac{\alpha_{44}}{
x_{\tau}^2
+
y_{\tau}^2
+
z_{\tau}^2
+
t_{\tau}^2
}
\nonumber
\end{eqnarray}

$\widehat{\phi}_{1-4}$ are source terms that are used to obtain
orthogonal grid at the boundaries, and to cluster grid points as
necessary in the domain.  These source terms are determined iteratively
as the solution converges.  They begin with a zero value.

\subsection{Flux Jacobian Matrices}

Using $\sigma$ $\left(\sigma = \xi, \eta, \zeta, \tau \right)$ as the $n$ 
$\left(n = 1, 2, 3, 4 \right)$  curvilinear direction, the inviscid
flux Jacobian matrix is:

\begin{eqnarray}
\left[A \right]_{\sigma}
&=&
\left[
\begin{array}{cccc}
\alpha_{nn} \widehat{\phi}_n & 0 & 0 & 0 \\
0 & \alpha_{nn} \widehat{\phi}_n & 0 & 0 \\
0 & 0 & \alpha_{nn} \widehat{\phi}_n & 0 \\
0 & 0 & 0 & \alpha_{nn} \widehat{\phi}_n 
\end{array}
\right]
\nonumber
\end{eqnarray}

and it's pretty clear that the magnitude of the maximum eigenvalue is:

\begin{eqnarray}
\epsilon_{\sigma} &=& \left|
\alpha_{nn} \widehat{\phi}_n
\right|
\nonumber
\end{eqnarray}

\emph{Note that the A matrix is very likely zero through a large portion
of the domain!}

The viscous flux Jacobian matrix is:

\begin{eqnarray}
\left[B \right]_{\sigma}
&=&
\left[
\begin{array}{cccc}
\alpha_{nn} + x_{\sigma}^2 \beta_n & 
x_{\sigma} y_{\sigma} \beta_n & 
x_{\sigma} z_{\sigma} \beta_n & 
x_{\sigma} t_{\sigma} \beta_n \\
x_{\sigma} y_{\sigma} \beta_n & 
\alpha_{nn} + y_{\sigma}^2 \beta_n & 
y_{\sigma} z_{\sigma} \beta_n & 
y_{\sigma} t_{\sigma} \beta_n \\
x_{\sigma} z_{\sigma} \beta_n & 
y_{\sigma} z_{\sigma} \beta_n & 
\alpha_{nn} + z_{\sigma}^2 \beta_n & 
z_{\sigma} t_{\sigma} \beta_n \\
x_{\sigma} t_{\sigma} \beta_n & 
y_{\sigma} t_{\sigma} \beta_n & 
z_{\sigma} t_{\sigma} \beta_n &
\alpha_{nn} + t_{\sigma}^2 \beta_n
\end{array}
\right]
\nonumber
\end{eqnarray}

Some notes here:  The B matrix is full, so I'll need to use a matrix
solver to get the $\Delta Q$'s during the LU-SGS sweeps.

The same formulation of the LU-SGS scheme will be used for both the flow
solver and the grid generator, trusting it works in multidimensions.

\emph{If} the LU-SGS scheme performs well, I'm planning to use a multigrid
version of the LU-SGS method as the default scheme for our group -- until
there's something clearly better.
