
    ! Returns M_theta and the corresponding sound speed as defined in
    ! SourceTermSymbolicSolver.ipynb
    
    SUBROUTINE CalcSoundSpeed(& 
    r                 , &
    SoundSpeedExpected, &
    thetaMachData     , &
    axialMachData)
           
    REAL(KIND=rDef)   , DIMENSION(:), INTENT(INOUT) :: &
    SoundSpeedExpected, thetaMachData, axialMachData
    
    REAL(KIND=rDef)   , DIMENSION(:), INTENT(IN) :: &
    r
    
    
    ! Local variables 
    INTEGER :: &
    numberOfGridPoints, i!, j
    
    numberOfGridPoints = SIZE(SoundSpeedExpected)
    
    DO i = 1,numberOfGridPoints
    
            SoundSpeedExpected(i) = 0.03125d0*tanh(0.042857142857142858d0*r(i) - 0.042857142857142858d0) + &
      0.03125d0*tanh(0.042857142857142858d0*r(i) - 0.037857142857142853d0 &
      ) + 0.03125d0*tanh(0.042857142857142858d0*r(i) - &
      0.032857142857142863d0) + 0.03125d0*tanh(0.042857142857142858d0*r(i) &
      - 0.027857142857142858d0) + 0.03125d0*tanh(0.042857142857142858d0 &
      *r(i) - 0.022857142857142854d0) + 0.03125d0*tanh( &
      0.042857142857142858d0*r(i) - 0.01785714285714286d0) + 0.03125d0* &
      tanh(0.042857142857142858d0*r(i) - 0.012857142857142855d0) + &
      0.996719324059932d0
        thetaMachData(i)      = 1.58113883008419d0*sqrt(r(i)*1d0/(0.0313528585687589d0*tanh( &
      0.042857142857142858d0*r(i) - 0.042857142857142858d0) + &
      0.0313528585687589d0*tanh(0.042857142857142858d0*r(i) - &
      0.037857142857142853d0) + 0.0313528585687589d0*tanh( &
      0.042857142857142858d0*r(i) - 0.032857142857142863d0) + &
      0.0313528585687589d0*tanh(0.042857142857142858d0*r(i) - &
      0.027857142857142858d0) + 0.0313528585687589d0*tanh( &
      0.042857142857142858d0*r(i) - 0.022857142857142854d0) + &
      0.0313528585687589d0*tanh(0.042857142857142858d0*r(i) - &
      0.01785714285714286d0) + 0.0313528585687589d0*tanh( &
      0.042857142857142858d0*r(i) - 0.012857142857142855d0) + 1)*( &
      -0.00268738787732219d0*tanh(0.042857142857142858d0*r(i) - &
      0.042857142857142858d0)**2 - 0.00268738787732219d0*tanh( &
      0.042857142857142858d0*r(i) - 0.037857142857142853d0)**2 - &
      0.00268738787732219d0*tanh(0.042857142857142858d0*r(i) - &
      0.032857142857142863d0)**2 - 0.00268738787732219d0*tanh( &
      0.042857142857142858d0*r(i) - 0.027857142857142858d0)**2 - &
      0.00268738787732219d0*tanh(0.042857142857142858d0*r(i) - &
      0.022857142857142854d0)**2 - 0.00268738787732219d0*tanh( &
      0.042857142857142858d0*r(i) - 0.01785714285714286d0)**2 - &
      0.00268738787732219d0*tanh(0.042857142857142858d0*r(i) - &
      0.012857142857142855d0)**2 + 0.0188117151412553d0))
        axialMachData(i)      = 0.01875d0*tanh(71.428571428571431d0*r(i) - 71.428571428571431d0) + &
      0.01875d0*tanh(71.428571428571431d0*r(i) - 46.428571428571431d0) + &
      0.01875d0*tanh(71.428571428571431d0*r(i) - 21.428571428571427d0) + &
      0.2625d0

    
    END DO
    
    END SUBROUTINE CalcSoundSpeed
    
