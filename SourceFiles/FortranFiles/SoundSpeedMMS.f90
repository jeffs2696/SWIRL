 
    ! Returns M_theta and the corresponding sound speed as defined in
    ! SourceTermSymbolicSolver.ipynb
    
    SUBROUTINE CalcSoundSpeed(& 
    r                 , &
    SoundSpeedExpected, &
    thetaMachData     , &
    axialMachData)
           
    
    REAL(KIND=rDef)   , DIMENSION(:), INTENT(INOUT) :: &
    SoundSpeedExpected, thetaMachData, axialMachData
    
    REAL(KIND=rDef)   , DIMENSION(:), INTENT(IN) :: &
    r
    
    
    ! Local variables 
    INTEGER :: &
    numberOfGridPoints, i!, j
    
    numberOfGridPoints = SIZE(SoundSpeedExpected)
    
    DO i = 1,numberOfGridPoints
    
            SoundSpeedExpected(i) = 0.0227272727272727d0*tanh(0.42857142857142855d0*r(i) - &
      0.42857142857142855d0) + 0.0227272727272727d0*tanh( &
      0.42857142857142855d0*r(i) - 0.39523809523809522d0) + &
      0.0227272727272727d0*tanh(0.42857142857142855d0*r(i) - &
      0.3619047619047619d0) + 0.0227272727272727d0*tanh( &
      0.42857142857142855d0*r(i) - 0.32857142857142857d0) + &
      0.0227272727272727d0*tanh(0.42857142857142855d0*r(i) - &
      0.29523809523809524d0) + 0.0227272727272727d0*tanh( &
      0.42857142857142855d0*r(i) - 0.26190476190476192d0) + &
      0.0227272727272727d0*tanh(0.42857142857142855d0*r(i) - &
      0.22857142857142854d0) + 0.0227272727272727d0*tanh( &
      0.42857142857142855d0*r(i) - 0.19523809523809527d0) + &
      0.0227272727272727d0*tanh(0.42857142857142855d0*r(i) - &
      0.16190476190476191d0) + 0.0227272727272727d0*tanh( &
      0.42857142857142855d0*r(i) - 0.12857142857142856d0) + &
      0.966462644531167d0
        thetaMachData(i)      = 1.58113883008419d0*sqrt(r(i)*1d0/(0.0235159349984994d0*tanh( &
      0.42857142857142855d0*r(i) - 0.42857142857142855d0) + &
      0.0235159349984994d0*tanh(0.42857142857142855d0*r(i) - &
      0.39523809523809522d0) + 0.0235159349984994d0*tanh( &
      0.42857142857142855d0*r(i) - 0.3619047619047619d0) + &
      0.0235159349984994d0*tanh(0.42857142857142855d0*r(i) - &
      0.32857142857142857d0) + 0.0235159349984994d0*tanh( &
      0.42857142857142855d0*r(i) - 0.29523809523809524d0) + &
      0.0235159349984994d0*tanh(0.42857142857142855d0*r(i) - &
      0.26190476190476192d0) + 0.0235159349984994d0*tanh( &
      0.42857142857142855d0*r(i) - 0.22857142857142854d0) + &
      0.0235159349984994d0*tanh(0.42857142857142855d0*r(i) - &
      0.19523809523809527d0) + 0.0235159349984994d0*tanh( &
      0.42857142857142855d0*r(i) - 0.16190476190476191d0) + &
      0.0235159349984994d0*tanh(0.42857142857142855d0*r(i) - &
      0.12857142857142856d0) + 1)*(-0.0201565157129995d0*tanh( &
      0.42857142857142855d0*r(i) - 0.42857142857142855d0)**2 - &
      0.0201565157129995d0*tanh(0.42857142857142855d0*r(i) - &
      0.39523809523809522d0)**2 - 0.0201565157129995d0*tanh( &
      0.42857142857142855d0*r(i) - 0.3619047619047619d0)**2 - &
      0.0201565157129995d0*tanh(0.42857142857142855d0*r(i) - &
      0.32857142857142857d0)**2 - 0.0201565157129995d0*tanh( &
      0.42857142857142855d0*r(i) - 0.29523809523809524d0)**2 - &
      0.0201565157129995d0*tanh(0.42857142857142855d0*r(i) - &
      0.26190476190476192d0)**2 - 0.0201565157129995d0*tanh( &
      0.42857142857142855d0*r(i) - 0.22857142857142854d0)**2 - &
      0.0201565157129995d0*tanh(0.42857142857142855d0*r(i) - &
      0.19523809523809527d0)**2 - 0.0201565157129995d0*tanh( &
      0.42857142857142855d0*r(i) - 0.16190476190476191d0)**2 - &
      0.0201565157129995d0*tanh(0.42857142857142855d0*r(i) - &
      0.12857142857142856d0)**2 + 0.201565157129995d0))
        axialMachData(i)      = 0.01875d0*tanh(28.571428571428573d0*r(i) - 28.571428571428573d0) + &
      0.01875d0*tanh(28.571428571428573d0*r(i) - 18.571428571428573d0) + &
      0.01875d0*tanh(28.571428571428573d0*r(i) - 8.5714285714285712d0) + &
      0.262500000077293d0

    
    END DO
    
    END SUBROUTINE CalcSoundSpeed
    