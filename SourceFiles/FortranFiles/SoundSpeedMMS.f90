 
! Returns M_theta and the corresponding sound speed as defined in
! SourceTermSymbolicSolver.ipynb

    SUBROUTINE CalcSoundSpeed(& 
    r                 , &
    kappa          , &
    SoundSpeedExpected, &
    thetaMachData     , &
    axialMachData)
    
    REAL(KIND=rDef)   , INTENT(IN) :: &
    kappa
    
    REAL(KIND=rDef)   , DIMENSION(:), INTENT(INOUT) :: &
    SoundSpeedExpected, thetaMachData, axialMachData
    
    REAL(KIND=rDef)   , DIMENSION(:), INTENT(IN) :: &
    r
    
     
    ! Local variables 
    INTEGER :: &
    numberOfGridPoints, i!, j
    
    REAL(KIND = rDef) :: one,two,three
        
    one   = (1.0_rDef)    
    two   = (2.0_rDef)    
    three = (3.0_rDef)

    
    numberOfGridPoints = SIZE(SoundSpeedExpected)

        DO i = 1,numberOfGridPoints

        SoundSpeedExpected(i) = 0.0791666666666667d0*tanh(0.30000000300000002d0*r(i)- &
      0.30000000300000002d0) + 0.0791666666666667d0*tanh( &
      0.30000000300000002d0*r(i)- 0.25714286014285714d0) + &
      0.0791666666666667d0*tanh(0.30000000300000002d0*r(i)- &
      0.2142857172857143d0) + 0.0791666666666667d0*tanh( &
      0.30000000300000002d0*r(i)- 0.17142857442857143d0) + &
      0.0791666666666667d0*tanh(0.30000000300000002d0*r(i)- &
      0.12857143157142861d0) + 0.0791666666666667d0*tanh( &
      0.30000000300000002d0*r(i)- 0.085714288714285769d0) + &
      0.0791666666666667d0*tanh(0.30000000300000002d0*r(i)- &
      0.042857145857142905d0) + 0.0791666666666667d0*tanh( &
      0.30000000300000002d0*r(i)- 3.0000000300000003d-9) + &
      0.856585619719089d0
        thetaMachData(i)      = 1.58113883008419d0*sqrt(r(i)*(-0.0554527176052492d0*tanh( &
      0.30000000300000002d0*r(i)- 0.30000000300000002d0)**2 - &
      0.0554527176052492d0*tanh(0.30000000300000002d0*r(i)- &
      0.25714286014285714d0)**2 - 0.0554527176052492d0*tanh( &
      0.30000000300000002d0*r(i)- 0.2142857172857143d0)**2 - &
      0.0554527176052492d0*tanh(0.30000000300000002d0*r(i)- &
      0.17142857442857143d0)**2 - 0.0554527176052492d0*tanh( &
      0.30000000300000002d0*r(i)- 0.12857143157142861d0)**2 - &
      0.0554527176052492d0*tanh(0.30000000300000002d0*r(i)- &
      0.085714288714285769d0)**2 - 0.0554527176052492d0*tanh( &
      0.30000000300000002d0*r(i)- 0.042857145857142905d0)**2 - &
      0.0554527176052492d0*tanh(0.30000000300000002d0*r(i)- &
      3.0000000300000003d-9)**2 + 0.443621740841993d0)/( &
      0.0924211950845367d0*tanh(0.30000000300000002d0*r(i)- &
      0.30000000300000002d0) + 0.0924211950845367d0*tanh( &
      0.30000000300000002d0*r(i)- 0.25714286014285714d0) + &
      0.0924211950845367d0*tanh(0.30000000300000002d0*r(i)- &
      0.2142857172857143d0) + 0.0924211950845367d0*tanh( &
      0.30000000300000002d0*r(i)- 0.17142857442857143d0) + &
      0.0924211950845367d0*tanh(0.30000000300000002d0*r(i)- &
      0.12857143157142861d0) + 0.0924211950845367d0*tanh( &
      0.30000000300000002d0*r(i)- 0.085714288714285769d0) + &
      0.0924211950845367d0*tanh(0.30000000300000002d0*r(i)- &
      0.042857145857142905d0) + 0.0924211950845367d0*tanh( &
      0.30000000300000002d0*r(i)- 3.0000000300000003d-9) + 1))
        axialMachData(i)      = 0.00125d0*tanh(50.000000500000006d0*r(i)- 50.000000500000006d0) + &
      0.00125d0*tanh(50.000000500000006d0*r(i)- 37.500000500000006d0) + &
      0.00125d0*tanh(50.000000500000006d0*r(i)- 25.000000500000002d0) + &
      0.00125d0*tanh(50.000000500000006d0*r(i)- 12.500000500000006d0) + &
      0.00125d0*tanh(50.000000500000006d0*r(i)- 5.000000050000001d-7) + &
      0.00500000000003472d0


        END DO

    END SUBROUTINE CalcSoundSpeed
